<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    <title>购物车</title>

    <link href="bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
  </head>
  <body>
      <div class="container">
          <div class="row header-title">
              <div class="col-xs-12">
                  <div class="center-block">
                      <h3>购物车</h3>
                  </div>
              </div>
          </div>
          <div class="" id="container" style="margin-bottom:20px;">

          </div>
          <div class="row">
              <div class="col-xs-12" style="color:#f00;">
                  总计： <span id="currency">￥</span><span id="totalAmount"></span>
              </div>
          </div>
         
          <div class="row" style="margin-top:20px;">
              <div class="col-xs-12 col-sm-6">
                 
                 币种：<select  id="select_currency">
                         <option value="￥">CNY</option>
                         <option value="HK$">HKD</option>
                         <option value="$">USD</option>
                      </select>                
              </div>
          </div>

          <div class="row" style="margin-top:20px;">
              <div class="col-xs-12">
                  <div class="btn btn-lg btn-block btn-primary" id="payBtn">
                     一键支付
                  </div>
                
              </div>
          </div>

 <div class="row" style="margin-top:20px;">
              <div class="col-xs-12">
                  <div class="btn btn-lg btn-block btn-primary" id="wPayBtn">
                    微信支付
                  </div>
                
              </div>
          </div>
            
      </div>
    <script src="bower_components/jquery/dist/jquery.min.js"></script>
    <script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="handlebars-v2.0.0.js"></script>
    <script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js" ></script>
     <script src="yunshouyin/base64.js" type="text/javascript"></script>
     <script src="yunshouyin/yunshouyin-1.0.js" type="text/javascript"></script>
    <script src="cart.js"></script>
    <script >



    var currency=$("#select_currency").val();
      $("#currency").html(currency);
     $('#select_currency').change(function() {
      var currency=$("#select_currency").val();
      $("#currency").html(currency);
     });


      $('#payBtn').click(function() {
               var sumAmount = $("#totalAmount").text();
               var currency=$("#select_currency").find('option:selected').text();        
               var orderNum = "";
               for (var i = 0; i < 12; i++) {
               orderNum = orderNum + Math.floor(Math.random() * 10);
        }
          var orderData = {
                orderNumber: orderNum,
                orderAmount: sumAmount,
                orderCurrency: "CNY",
                backUrl: "status.html",
                frontUrl: "http://qrcode.cardinfolink.net/sdkdemo/status.html",
                merID: "100000000000013",
                inscd:"10134001",           
                secretKey: "1dgvvzp4jahxjmwtbavxurx2pxkiykwb",
                goodsInfo:"江西福彩",
                attach:""

        };

         yunshouyin.startOneKeyPay(orderData,true);
            });

   

$('#wPayBtn').click(function() {
               var sumAmount = $("#totalAmount").text();
               var currency=$("#select_currency").find('option:selected').text();        
               var orderNum = "";
               for (var i = 0; i < 12; i++) {
               orderNum = orderNum + Math.floor(Math.random() * 10);
        }

       
       var orderData = {
  orderNumber:orderNum,
  orderAmount: "0.01",
  orderCurrency: "CNY",
  backUrl:"http://www.baidu.com",
  frontUrl: "status.html",
  merID: "991421073920001",
  inscd:"99911888",           
  secretKey: "330265e59426d9723f87d0a5b86bb97d",
  goodsInfo:"江西福彩",
  attach:'{"chk":"c29a4f57a914229d14fcc8c4c81719f0","zhushu":"1","zhuma":"1001*031719232733~09^","vmoney":0.01,"playname":"B001","mobile":null,"idcard":null,"siteID":0,"caiminID":null,"buydate":1439951710}'  //透传数据
  };
  
  //yunshouyin.startWxPay(orderData,false);//为true时为调用测试环境，为false时，调用生产环境


 // var orderData = {
 //       orderNumber: orderNum,
 //       orderAmount: "0.01",
 //       orderCurrency: "CNY",
 //       backUrl: "http://zqq19500.oicp.net/weixinwap/weixinController/getinfo",
 //       frontUrl: "http://yinjunonly.oicp.net:23475/b2b/user/my_cp.html",
 //       merID: "100000000000402",
 //       inscd: "99911888",
 //       secretKey: "222277e3718c47cfb47a89a6fbc9d361",
 //       goodsInfo:"",
 //       attach:"username:15800359796;type=account"
 //     };


         yunshouyin.startWPay(orderData,false);
            });


function curentTime()
{ 
    var now = new Date();
    
    var year = now.getYear();       //年
    var month = now.getMonth() + 1;     //月
    var day = now.getDate();            //日
    
    var hh = now.getHours();            //时
    var mm = now.getMinutes();          //分
    var ss = now.getSeconds();           //秒
    
    var clock = year;
    
    if(month < 10){
      clock += "0";
    }
    
    clock += month;
    
    if(day < 10){
      clock += "0";
    }    
    clock += day;
    if(hh < 10){
      clock += "0";
    }  
    clock += hh;
    if (mm < 10){
      clock += '0';
    }  
    clock += mm; 
     
    if (ss < 10){
      clock += '0';
    } 
    clock += ss; 
    return(clock); 
}

    </script>
    <script id="itemTemplate" type="text/x-handlebars-template">

        <div class="cart-item">
            <div class="cart-item-pic">
                <img src="{{pic}}" alt="{{name}}" />
            </div>
                {{price}} * {{count}}
            <div class="cart-item-amount">
                {{total}}元
            </div>
        </div>
    </script>
  </body>
</html>
